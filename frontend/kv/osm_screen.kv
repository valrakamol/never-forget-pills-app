<OsmScreen>:
    elder_list_layout: elder_list_layout
    welcome_label: welcome_label
    search_input: search_input

    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: (245/255, 245/255, 245/255, 1) # พื้นหลังสีเทาอ่อน
            Rectangle:
                pos: self.pos
                size: self.size

        # --- Header Bar (ส่วนหัวสีเขียว) ---
        BoxLayout:
            size_hint_y: None
            height: '60dp'
            canvas.before:
                Color:
                    rgba: (119/255, 217/255, 161/255, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size
            Label:
                id: welcome_label
                text: 'รายชื่อผู้สูงอายุ (อสม.)'
                font_name: 'THFont'
                font_size: '22sp'
                color: 1, 1, 1, 1
                bold: True

        # --- Search Bar ---
        BoxLayout:
            size_hint_y: None
            height: '56dp'
            padding: ['8dp', '8dp', '8dp', '8dp']
            spacing: '8dp'
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    pos: self.pos
                    size: self.size
            TextInput:
                id: search_input
                hint_text: 'ค้นหาจากผู้สูงอายุในความดูแล...'
                font_name: 'THFont'
                font_size: '16sp'
                multiline: False
                on_text_validate: root.filter_elder_list(self.text)
                background_color: 0.95, 0.95, 0.95, 1
            Button:
                text: 'ค้นหา'
                font_name: 'THFont'
                font_size: '16sp'
                size_hint_x: None
                width: '100dp'
                on_release: root.filter_elder_list(search_input.text)
                background_normal: ''
                background_color: (50/255, 150/255, 100/255, 1)

        # --- พื้นที่แสดงรายชื่อผู้สูงอายุ ---
        ScrollView:
            id: elder_list_scroll
            bar_width: 0 # ซ่อน Scrollbar
            GridLayout:
                id: elder_list_layout
                cols: 1         
                size_hint_y: None
                height: self.minimum_height
                padding: '12dp'
                spacing: '12dp'
        
        # --- ปุ่มสำหรับไปหน้าเพิ่มผู้สูงอายุ ---
        BoxLayout:
            size_hint_y: None
            height: '70dp'
            padding: '10dp'
            Button:
                text: '+ เพิ่มผู้สูงอายุในความดูแล'
                font_name: 'THFont'
                font_size: '18sp'
                background_normal: ''
                background_color: (0.1, 0.5, 0.2, 1)
                on_release: root.go_to_add_elder_page()
            
        # Bottom Navigation Tabs (สำหรับผู้สูงอายุ)
        BoxLayout:
            id: bottom_nav
            orientation: 'horizontal'
            size_hint_y: None
            height: '56dp'
            spacing: 0
            canvas.before:
                Color:
                    rgba: (119/255, 217/255, 161/255, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size
            # Tab 1: รายชื่อผู้สูงอายุ
            Button:
                background_normal: ''
                background_color: 0,0,0,0
                on_release: root.manager.current = 'osm_screen'
                size_hint_x: 1
                BoxLayout:
                    pos: self.parent.pos
                    size: self.parent.size
                    orientation: 'vertical'
                    padding: [0, '2dp', 0, 0]
                    spacing: '2dp'
                    Image:
                        source: 'assets/icon_list_active.png'
                        size_hint: None, None
                        size: '28dp', '28dp'
                        pos_hint: {'center_x': 0.5}
                    Label:
                        text: 'รายชื่อผู้สูงอายุ'
                        font_name: 'THFont'
                        font_size: '12sp'
                        color: 0, 0, 0, 1
                        halign: 'center'
                        
            # Tab 2: แดชบอร์ด
            Button:
                background_normal: ''
                background_color: 0,0,0,0
                on_release: root.manager.current = 'osm_summary_screen'
                size_hint_x: 1
                BoxLayout:
                    pos: self.parent.pos
                    size: self.parent.size
                    orientation: 'vertical'
                    padding: [0, '2dp', 0, 0]
                    spacing: '2dp'
                    Image:
                        source: 'assets/icon_dashboard.png'
                        size_hint: None, None
                        size: '28dp', '28dp'
                        pos_hint: {'center_x': 0.5}
                    Label:
                        text: 'แดชบอร์ด'
                        font_name: 'THFont'
                        font_size: '12sp'
                        color: 1, 1, 1, 1
                        halign: 'center'

            # Tab 3: โปรไฟล์
            Button:
                background_normal: ''
                background_color: 0,0,0,0
                on_release: root.manager.current = 'osm_profile_screen'
                size_hint_x: 1
                BoxLayout:
                    pos: self.parent.pos
                    size: self.parent.size
                    orientation: 'vertical'
                    padding: [0, '2dp', 0, 0]
                    spacing: '2dp'
                    Image:
                        source: 'assets/icon_profile.png'
                        size_hint: None, None
                        size: '28dp', '28dp'
                        pos_hint: {'center_x': 0.5}
                    Label:
                        text: 'โปรไฟล์'
                        font_name: 'THFont'
                        font_size: '12sp'
                        color: 1, 1, 1, 1
                        halign: 'center'